---
title: "Lecture Note Week 3"
filters: 
  - webr
execute: 
  echo: false
---

::: callout-note
Learning Objective:
:::

```{r}
#| include: false

library(tidyverse)
library(knitr)
```

## Section 1: Introduction to Power BI

**Welcome to Power BI!**

Power BI is a powerful business analytics tool that enables you to visualize data, share insights, and make data-driven decisions. This introductory document will guide you through the basics of Power BI and help you get started with creating your first report.

### **1. What is Power BI?**

Power BI is a suite of business analytics tools by Microsoft that includes software, services, and connectors. It transforms your unrelated sources of data into coherent, visually immersive, and interactive insights. Your data may be an Excel spreadsheet, or a collection of cloud-based and on-premises hybrid data warehouses.

### **Getting Started**

#### **1. Download and Install Power BI Desktop**

-   Go to the [Power BI website](https://powerbi.microsoft.com/desktop/) and download the Power BI Desktop.

-   Follow the installation instructions to install Power BI Desktop on your computer.

#### **2. Open Power BI Desktop**

Once installed, open Power BI Desktop. You will see the following interface:

![](https://s33046.pcdn.co/wp-content/uploads/2022/02/power-bi-desktop-layout.png)

#### **3. Connect to Data**

To start working with data, you need to connect Power BI to your data source. Here's how:

-   Click on the "Home" tab.

-   Click on the "Get Data" button.

![](https://learn.microsoft.com/vi-vn/power-bi/connect-data/media/desktop-quickstart-connect-to-data/qs-connect-data_02.png)

-   Select your data source from the list (e.g., Excel, SQL Server, Web, etc.).

-   Follow the prompts to load your data into Power BI.

#### **4. Transform Data with Power Query Editor**

After loading your data, you might need to clean and transform it. Use Power Query Editor for this purpose:

-   Click on the "Home" tab.

-   Click on the "Transform Data" button.

![](https://learn.microsoft.com/en-us/power-bi/transform-model/media/desktop-query-overview/query-overview-transform.png)

The Power Query Editor will open, where you can clean and prepare your data.

![](https://learn.microsoft.com/en-us/power-query/media/power-query-ui/pqui-user-interface.png)

#### **5. Create Visualizations**

Once your data is ready, you can start creating visualizations:

-   Go back to the main Power BI Desktop window.

-   In the "Visualizations" pane, select the type of visualization you want to create (e.g., bar chart, line chart, pie chart, etc.).

-   Drag and drop fields from the "Fields" pane to the "Values", "Axis", "Legend", etc., in the "Visualizations" pane.

![](https://learn.microsoft.com/en-us/power-bi/visuals/media/power-bi-report-add-visualizations-i/add-visual-1.png)

#### **6. Build Reports**

Combine multiple visualizations into a report:

-   Use the "Report" view in Power BI Desktop.

-   Arrange your visualizations on the canvas.

-   Add titles, labels, and other elements to enhance your report.

#### **7. Save and Publish Your Report ðŸ‘ˆ (This feature will not be taught for this course as it needs a paid version)**

-   Click on the "File" tab.

-   Select "Save As" to save your report locally.

-   To share your report, click on the "Publish" button.

![](https://learn.microsoft.com/vi-vn/power-bi/create-reports/media/desktop-upload-desktop-files/pbid_publish_publishbutton.png)

Follow the prompts to publish your report to the Power BI service, where you can share it with others.

### **Conclusion**

Congratulations! You have successfully created your first Power BI report. Power BI is a versatile tool with many advanced features, so continue exploring and experimenting to unlock its full potential. Happy data analyzing!

# Section 2: Data Wrangling in Power BI

#### 1. Introduction to Power BI

**Overview of Power BI:** Power BI is a suite of business analytics tools that deliver insights throughout your organization. You can connect to hundreds of data sources, simplify data prep, and drive ad hoc analysis. Produce beautiful reports, then publish them for your organization to consume on the web and across mobile devices.

**Understanding the Power BI Interface:**

-   **Home Ribbon:** Access common actions like getting data, viewing data transformations, and publishing reports.

-   **Report View:** Design your report using various visualizations.

-   **Data View:** See the data tables and make transformations.

-   **Model View:** Manage the relationships between different tables in your dataset.

-   **Fields Pane:** Contains the tables and fields in your data model.

-   **Visualizations Pane:** Choose from a variety of visualizations to represent your data.

**Connecting to Various Data Sources:** To get started, open Power BI and load your dataset:

1.  Go to the **Home** tab and click **Get Data**.

2.  Choose the type of data source (e.g., Excel, SQL Server, etc.).

3.  Navigate to the location of your dataset (in this case, the "Store Sales.pbix" file) and load it into Power BI.

#### 2. Data Import and Transformation

**Importing Data:** Once the dataset is loaded, you can see the data in the **Data View**. If needed, you can refresh the data to get the latest updates.

**Using Power Query Editor:**

1.  Click on **Transform Data** to open the Power Query Editor.

2.  In the Power Query Editor, you can see a list of queries (tables) on the left, the data preview in the middle, and applied steps on the right.

**Applying Transformations:**

-   **Filtering:** Remove rows that donâ€™t meet certain criteria.

-   **Sorting:** Sort data based on one or more columns.

-   **Merging:** Combine columns or rows from different tables.

-   **Appending:** Add rows from one table to another.

#### 3. Data Cleaning Techniques

**Handling Missing Values:**

-   Use the **Remove Rows** or **Replace Values** feature to handle missing data.

**Removing Duplicates:**

-   Select the column(s) where you want to remove duplicates and use the **Remove Duplicates** feature.

**Text Cleaning:**

-   **Trim:** Remove leading and trailing spaces.

-   **Replace Values:** Replace specific text values with others.

-   **Case Conversion:** Convert text to uppercase, lowercase, or proper case.

**Splitting and Merging Columns:**

-   **Split Column:** Split a column into multiple columns based on a delimiter or fixed number of characters.

-   **Merge Columns:** Combine multiple columns into one, separated by a delimiter.

#### 4. Data Shaping

**Pivoting and Unpivoting Data:**

-   **Pivot Columns:** Turn unique values from one column into multiple columns.

-   **Unpivot Columns:** Transform columns into rows to normalize data.

**Grouping and Summarizing Data:**

-   Use the **Group By** feature to aggregate data (e.g., sum, average) based on one or more columns.

**Creating Custom Columns:**

-   Use the **Add Column** tab to create custom columns with M language formulas or pre-built functions.

**Using Conditional Column:**

-   Create new columns based on conditions using the **Conditional Column** feature.

#### 5. Data Types and Formats

**Changing Data Types:**

-   Ensure each column has the correct data type (e.g., text, number, date). Change the data type by selecting the column and choosing the appropriate type from the **Transform** tab.

**Formatting Numbers, Dates, and Text:**

-   Format numbers (e.g., currency, percentage), dates (e.g., short date, long date), and text to ensure consistency and readability.

**Importance of Data Types in Power BI:**

-   Correct data types are crucial for accurate calculations, aggregations, and visualizations. Incorrect data types can lead to errors and misleading insights.

### Practical Example Using the "Store Sales" Dataset.

Click [here](%22./data/Store%20Sales.pbix%22) to get the store data.

#### Step-by-Step Guide:

1.  **Load the Dataset:**

    -   Open Power BI Desktop.

    -   Click **File** \> **Open** and select "Store Sales.pbix".

2.  **Transform Data:**

    -   Click **Transform Data** to open the Power Query Editor.

    -   **Filter Rows:** Remove rows with null values in critical columns (e.g., Sales Amount).

    -   **Remove Duplicates:** Select the "Transaction ID" column and remove duplicates.

    -   **Trim Text:** Select text columns like "Customer Name" and trim spaces.

    -   **Split Column:** Split "Full Name" into "First Name" and "Last Name" using space as a delimiter.

    -   **Group By:** Group data by "Store" to calculate the total sales per store.

    -   **Pivot Data:** Pivot the "Month" column to create a monthly sales report.

3.  **Data Cleaning:**

    -   Replace missing values in the "Sales Amount" column with 0.

    -   Convert the "Date" column to the Date type.

    -   Format the "Sales Amount" column as Currency.

4.  **Data Shaping:**

    -   Unpivot columns to normalize the data structure.

    -   Create a new custom column to categorize sales amounts (e.g., Low, Medium, High).

5.  **Finalizing the Data Model:**

    -   Ensure all columns have the correct data types.

    -   Check relationships between tables in the **Model View**.

By following these steps, you can effectively wrangle data in Power BI, ensuring it's clean, structured, and ready for analysis and visualization.
